<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hmrz.mybatis.dbtag">

    <select id="count" parameterType="DBTagSearch" resultType="int">
        SELECT
          COUNT(*)
        FROM db_tag
        <where>
            <if test="name != null and name != ''">
                name LIKE CONCAT('%',#{name},'%') 
            </if>
            <if test="type != null and type != ''">
                AND type = #{type}
            </if>
            <if test="is_available != null and is_available != ''">
                AND is_available = #{is_available}
            </if>
        </where>
    </select>
    
    <select id="list" parameterType="DBTagSearch" resultType="DBTagBean">
        SELECT
		  id,
		  name,
		  type,
		  is_available
		FROM db_tag
		<where>
            <if test="name != null and name != ''">
                name LIKE CONCAT('%',#{name},'%') 
            </if>
            <if test="type != null and type != ''">
                AND type = #{type}
            </if>
            <if test="is_available != null and is_available != ''">
                AND is_available = #{is_available}
            </if>
        </where>
		<if test="havePage == 1">
            LIMIT #{start},#{rows}
        </if>
    </select>

    <insert id="add" parameterType="DBTagBean">
        INSERT INTO db_tag(name, type, is_available) VALUE(#{name}, #{type}, #{is_available})
    </insert>
    
    <update id="modify" parameterType="DBTagBean">
        UPDATE db_tag SET id = #{id}
        <if test="name != null and name != ''">
            ,name = #{name}
        </if>
        <if test="type != null and type != ''">
            ,type = #{type}
        </if>
        <if test="is_available != null and is_available != ''">
            ,is_available = #{is_available}
        </if>
        WHERE id = #{id}
    </update>
</mapper>